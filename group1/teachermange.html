<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap 101 Template</title>
    <link href="dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="teachcss.css">
    <link rel="stylesheet" href="font-awesome-4.7.0/css/font-awesome.min.css">
    <!--[if lt IE 9]>
    <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<section class="section">
    <div class="div-top">
        <div class="div-left" data-toggle="modal" data-target="#myModal"><i class="fa fa-plus" aria-hidden="true"></i>
            新增职工</div>
        <div class="div-right">
            <input contenteditable="true" class="div-search" id="search" placeholder="输入姓名/职务">
            <div class="div-button" id="look" onclick="search1();">查询</div>
        </div>
    </div>
    <div>
        <table class="table  col-lg-12" id="teacTalbe">
            <thead>
            <tr class="table-tr table-hea">
                <th class="col-lg-1"></th>
                <th class="col-lg-1">编号</th>
                <th class="col-lg-1">姓名</th>
                <th class="col-lg-1">性别</th>
                <th class="col-lg-1">手机号码</th>
                <th class="col-lg-1">职务</th>
                <th class="col-lg-1">部门</th>
                <th class="col-lg-1">出生年月</th>
                <th class="col-lg-1">邮箱</th>
                <th class="col-lg-3">操作</th>
            </tr>
            </thead>
           <tbody>

           </tbody>
        </table>
    </div>
    <div class="foot-div">
        <div class="sele-tr">全选</div>
        <div class="del-tr" onclick="delectAll();" data-toggle='modal' data-target='#myModal2'>删除</div>
    </div>
    <div class="footer">

        <div class="footer-1">
            <span>第</span>
            <select name="" id="" class="footer-sele">
                <option value="">1</option>
                <option value="">2</option>
                <option value="">3</option>
            </select>
                    <span>页</span>
                    <span class="footer-ma">共3页</span>
                    <span class="footer-ma">&lt&lt</span>
                    <span>&gt&gt</span>
        </div>
    </div>
</section>
<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">添加职工</h4>
            </div>
            <div class="modal-body">
                <div class="modal-left">
                    <div>
                        <label for="">姓名<span>*</span></label>
                        <input type="text" id="name" class="clearTe">
                        <label id="nameText" class="remind"></label>
                    </div>

                    <div class="male">
                        <label for="">性别<span>*</span></label>
                        <input type="radio" name="sex" id="man"><span>男</span>
                        <input type="radio" name="sex" id="woman"><span>女</span>
                        <label id="sexText" class="remind"></label>
                    </div>

                    <div>
                        <label for="">手机号码<span>*</span></label>
                        <input type="text" id="phone" class="clearTe">
                        <label class="remind" id="phoneText"></label>
                    </div>
                    <div>
                        <label>部门<span>*</span></label>
                        <select name="" id="mydapa" class="clearTe">
                            <option value="">----请选择部门----</option>
                            <option >行政办</option>
                            <option >财务部</option>
                            <option >后勤部</option>
                            <option>教育部</option>
                            <option >保卫科</option>
                        </select>
                        <label id="dapaText" class="remind"></label>
                    </div>
                   <div class="time">
                       <label for="">出生日期</label>
                       <input type="date" max="2000-01-01" min="1920-01-01" value="" id="time" class="clearTe">
                       <label id="timeText" class="remind"></label>
                   </div>

                   <div>
                       <label for="">职务<span>*</span></label>
                       <select name="" id="myteach" class="clearTe">
                           <option value="">----请选择职务----</option>
                           <option>主课教师</option>
                           <option>副科教师</option>
                       </select>
                       <label id="teachText" class="remind"></label>
                   </div>
                    <div>
                        <label for="">邮箱</label>
                        <input type="email" id="email" class="clearTe" multiple="true">
                        <label id="emailText" class="remind"></label>
                    </div>

                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="mydefault" onclick="clearText();">重置</button>
                <button type="button" class="myprimary submit" data-dismiss="" onclick="result();">确认</button>
            </div>
        </div>
    </div>
</div>
<!-- Small modal -->
<!--<div class="modal fade bs-example-modal-sm" id="smalModal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="mySmallModalLabel">提示信息</h4>
            </div>
            <div class="modal-body small-div">
                <div class="sma-moda-size">操作成功</div>
                <div class="sma-moda-color">页面自动跳转，等待时间：<span id="modalTime">3</span></div>
                <div></div>
            </div>

        </div>
    </div>
</div>-->
<!-- Modal -->
<div class="modal fade" id="myModal2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel2">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel2">提示信息</h4>
            </div>
            <div class="modal-body">
                <div>
                    <p>是否确认删除？</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="mydefault" data-dismiss="modal" >取消</button>
                <button type="button" class="myprimary " data-dismiss="modal" data-target='.bs-example-modal-sm' data-toggle='modal' onclick="deleteSure();">确认</button>
            </div>
        </div>
    </div>
</div>
<!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->
<script src="dist/js/jquery-3.3.1.js"></script>
<!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
<script src="dist/js/bootstrap.min.js"></script>
<script>
    var teachArry=[
        {no1:1,name:"夏天",gender:"女",tel:"15128282223",duty:"主课教师",dapa:"行政办",data:"1994-01-01",emal:"7848488455@qq.com"},
        {no1:2,name:"夏雨",gender:"女",tel:"13585858425",duty:"主课教师",dapa:"教育部",data:"1991-11-24",emal:"78484884@qq.com"},
        {no1:3,name:"夏雪",gender:"女",tel:"18125021234",duty:"主课教师",dapa:"保卫科",data:"1992-07-09",emal:"784848242@qq.com"},
        {no1:4,name:"夏冰雹",gender:"男",tel:"18554849654",duty:"主课教师",dapa:"后勤部",data:"1995-04-30",emal:"7848489342@qq.com"},
        {no1:5,name:"夏冰冰",gender:"女",tel:"18355922532",duty:"主课教师",dapa:"行政办",data:"1949-01-01",emal:"78484812121@qq.com"}
    ];
    window.onload=showData;
    var num=2;
    var clearmodal;
    var cleartime;
    function showData() {
        var teachTable=$("#teacTalbe tbody").get(0);
        teachTable.innerHTML="";
        for (var i=0;i<teachArry.length;i++){
            teachTable.innerHTML+="<tr class='table-tr look-tr'>"+"<td>"+"<input type='checkbox' class='table-input'>"+
                "</td>"+"<td>"+(i+1)+"</td>"+ "<td class='teachName'>"+teachArry[i].name+"</td>"+
                    "<td>"+teachArry[i].gender+"</td>"+
                "<td>"+teachArry[i].tel+"</td>"+"<td class='teachDuty'>"+teachArry[i].duty+"</td>"+
                "<td>"+teachArry[i].dapa+"</td>"+
                "<td>"+teachArry[i].data+"</td>"+"<td>"+teachArry[i].emal+"</td>"+
                "<td class='table-div'>"+"<div class='tedit' onclick='editText("+i+");' data-target='#myModal' data-toggle='modal'>"+"编辑"+"</div>"+
                "<div class='del' onclick='delTeach("+i+")'data-toggle='modal' data-target='#myModal2'>"
                +"删除"+"</div>"+"</td>"
        }
    }
    var modalTime=document.getElementById("modalTime");


    var delTeachNum;
    var delTeachflage;
    /*点击删除的时候进行的操作*/
    function delTeach(str) {
        delTeachNum=str;
        delTeachflage=true;
    }
    /*确认删除后进行的操作*/
    function deleteSure() {
        if(delTeachflage){
            teachArry.splice(delTeachNum,1);
            showData();
        }else if(delAllNum){
            var myInput=document.getElementsByClassName("table-input");
            for (var i=0;i<myInput.length;i++){
                if(myInput[i].checked){
                    teachArry.splice(i,1);
                    $(myInput[i]).parent().parent().remove();
                    i--;
                    console.log(myInput.length,i);
                }
            }
            showData();

        }

    }

    $("#myModal2").on("hidden.bs.modal",function () {
        delTeachflage=false;
        delAllNum=false;
    });
  /*  $("#smalModal").on("shown.bs.modal",function () {
        clearmodal=setInterval(function () {
            $("#smalModal").modal("hide");

        },3000)
    });
    $("#smalModal").on("hidden.bs.modal",function () {
        clearInterval(clearmodal);
        clearInterval(cleartime);
        num=2;
        $("#modalTime").html("3");
    });*/
    /*模态框隐藏时，所有内容都清空*/
    $("#myModal").on("hidden.bs.modal",function () {
        $(".modal-body input").val("");
        $(".modal-body select").val("");
          $(".modal-body input[type='radio']").prop("checked",false);
            $(".remind").html("");
            editFalg=false;
        editNum=null;
    });
    $(".div-left").click(function () {
       $("#myModalLabel").html("新增职工");
    });
    var fagle=false;
    $(".sele-tr").click(function () {
        $(".table-input").attr("checked",!fagle);
        fagle=!fagle;
    });


    //提交新增职工时先获取input框中的值
    var teachName=document.getElementById("name");
    var teachSex=document.getElementById("man");
    var teachSex1=document.getElementById("woman");
    var teachPhone=document.getElementById("phone");
    var teachDapa=document.getElementById("mydapa");
    var teachTime=document.getElementById("time");
    var teach=document.getElementById("myteach");
    var teachEmail=document.getElementById("email");
    var phoneText1=document.getElementById("phoneText");
    var nameText1=document.getElementById("nameText");
    var sexText1=document.getElementById("sexText");
    var dapaText1=document.getElementById("dapaText");
    var timeText1=document.getElementById("timeText");
    var teachText1=document.getElementById("teachText");
    var emailText1=document.getElementById("emailText");
    var submit=document.getElementsByClassName("submit")[0];
    var idClass=document.getElementsByClassName("remind");
    /*单击提交按钮时进行判断*/
    function result() {
        for (var k=0;k<idClass.length;k++){
            idClass[k].innerText="";
        }
        var reg = /^[\u4e00-\u9fa5]{2,5}$/;
        var reg1=/^1[34578]\d{9}$/;
        var reg2 = /^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/;
        var judge;
        var judge1;
        var ju2;
        var flag=true;
        var flag1=true;

    var newTeachArry={name:teachName.value,tel:teachPhone.value,
        duty:teach.value,dapa:teachDapa.value,data:teachTime.value,emal:teachEmail.value};
        if(teachSex.checked){
            newTeachArry.gender="男";
        }else if(teachSex1.checked){
            newTeachArry.gender="女";
        }else {
            sexText1.innerText="请选择性别！";
            flag1=false;
            submit.setAttribute("data-dismiss","");
        }

        if(!editFalg){
            for(var i=0;i<teachArry.length;i++){
                if(teachPhone.value===teachArry[i].tel&&i!==editNum){
                    phoneText1.innerText="该手机号码已存在！";
                    submit.setAttribute("data-dismiss","");
                    flag=false;
                }
            }
        }
        judge=reg.test(teachName.value);
        ju2=reg1.test(teachPhone.value);
        judge1=reg2.test(teachEmail.value);
        if(!judge1){
            emailText1.innerText="邮箱格式不对！";
            submit.setAttribute("data-dismiss","");
        }
        if(!judge){
            nameText1.innerText="名字长度不能超过10个字！";
            submit.setAttribute("data-dismiss","");
        }
        if(!ju2){
            phoneText1.innerText="手机号码格式不对！";
            submit.setAttribute("data-dismiss","");
        }
        if(teachDapa.value===""){
            dapaText1.innerText="请选择部门!";
            submit.setAttribute("data-dismiss","");
        }
        if(teach.value===""){
            teachText1.innerText="请选择职务!";
            submit.setAttribute("data-dismiss","");
        }
        if(judge&&ju2&&teachDapa.value!==""&&teach.value!==""&&flag&&flag1&&judge1){
            if(editFalg){
                teachArry.splice(editNum,1,newTeachArry);
                editFalg=false;
            }else {
                teachArry.unshift(newTeachArry);
            }
            submit.setAttribute("data-dismiss","modal");

            showData();
        }
    }
    /*单击重置时的操作*/
    function clearText() {
        var clear1=document.getElementsByClassName("clearTe");
        for(var i=0;i<clear1.length;i++){
            clear1[i].value="";
        }
        for (var k=0;k<idClass.length;k++){
            idClass[k].innerText="";
        }
        $(".modal-body input[type='radio']").prop("checked",false);
    }
    /*单击编辑的操作*/
    var edH4=document.getElementById("myModalLabel");
    var editFalg=false;
    var editNum;
    function editText(str2) {
        edH4.innerText="编辑部门";
        console.log(teachArry[str2].gender);
        if(teachArry[str2].gender==="男"){
            teachSex.checked=true;
        }else {
            teachSex1.checked=true;
        }
        teachPhone.value=teachArry[str2].tel;
        teach.value=teachArry[str2].duty;
        teachDapa.value=teachArry[str2].dapa;
        teachTime.value=teachArry[str2].data;
        console.log(teachArry[str2].data);
        teachEmail.value=teachArry[str2].emal;
        teachName.value=teachArry[str2].name;
        editNum=str2;
        editFalg=true;
    }

    var delAllNum;
    /*下面删除按钮的单击事件*/
    function delectAll() {
        delAllNum=true;

    }
    /*查询功能*/
    var myseach=document.getElementById("search");
    var mytr=document.getElementsByClassName("teachName");
    var mytr2=document.getElementsByClassName("teachDuty");
    function search1() {
        var con=myseach.value;
        console.log(myseach.value);
        for(var i=0;i<mytr.length;i++){
            mytr[i].parentNode.style.display="none";
            console.log(mytr[i].innerText.indexOf(con));
            if(mytr[i].innerText.indexOf(con)!==-1||mytr2[i].innerText.indexOf(con)!==-1){
                mytr[i].parentNode.style.display="table-row";

            }
        }
    }
</script>
</body>
</html>